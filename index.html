
<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PESMASTER Formation Builder</title>
    <link rel="stylesheet" href="assets/css/style.css">
    <style>
        /* Add this to your existing styles or in the head if you don't have an external CSS file */
        #createdPlayers {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 20px;
            padding: 20px;
            background-color: #f0f0f0;
            margin-top: 20px;
        }
        #createdPlayers .card {
            width: 100%;
            height: auto;
            margin: 0;
        }
    </style>
</head>
<body>
    <div class="sidebar">
        <div>
            <label for="name">Name:</label>
            <input type="text" id="name" placeholder="Enter formation name">
        </div>
        <div>
            <label for="lineup">Lineup:</label>
            <select id="lineup">
                <option value="4-4-2">4-4-2</option>
                <option value="4-3-3">4-3-3</option>
                <option value="3-5-2">3-5-2</option>
            </select>
        </div>
        <button class="btn-primary" id="btn-primary">Create new</button>
    </div>

    <div class="main-content">
        <div class="header hidden fixed bottom-0 left-0 w-full px-4 py-2 bg-black text-white">
            <div class="logo flex items-center justify-between">
                ROYAL STRIKERS
                <img src="assets/images/logo.webp" alt="ROYAL STRIKERS" width="100px">
            </div>
        </div>
        
        <div class="formation" id="formation"></div>
        
        <!-- New section to display created players -->
        <h2>Created Players</h2>
        <div id="createdPlayers"></div>
    </div>
    
    <div id="playerModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>Select Player </h2>
            <div class="modal-filters">
                <input type="text" id="nameFilter" placeholder="Name">
                <select id="positionFilter">
                    <option value="">Position</option>
                    <option value="CF">CF</option>
                    <option value="LWF">LWF</option>
                    <option value="RWF">RWF</option>
                    <option value="GK">GK</option> 
                    <option value="CB">CB</option>
                    <option value="LB">LB</option> 
                    <option value="CM">CM</option> 
                    <option value="RB">RB</option> 
                    <option value="LW">LW</option>
                    <option value="RW">RW</option>
                    <option value="ST">ST</option>
                </select>
                <select id="nationalityFilter">
                    <option value="">Nationality</option>
                </select>
                <input type="range" id="ratingFilter" min="40" max="99" value="70">
                <span id="ratingValue">70</span>
            </div>
          
            <div class="players-grid" id="playersGrid"></div>
            <div id="playerCardsContainer" class="players-grid" ></div>
        </div>
    </div>
    <!-- <div id="playersGrid"></div> -->

    <!-- Conteneur pour afficher les cartes des joueurs -->


 
    <div class="modal-content" id="Formulaire_remplir">
        <h2>Create New Player</h2>
        <form id="newPlayerForm" enctype="multipart/form-data">
            <label for="newPlayerName">Nom Player: </label>
            <input type="text" id="newPlayerName" placeholder="Name" required>
    
            <label for="newPlayerPosition">Position: </label>
            <select id="newPlayerPosition" required>
                <option value="" hidden>Position</option>
                <option value="CF">CF</option>
                <option value="LWF">LWF</option>
                <option value="RWF">RWF</option>
                <option value="GK">GK</option>
                <option value="CB">CB</option>
                <option value="LB">LB</option>
                <option value="CM">CM</option>
                <option value="RB">RB</option>
                <option value="LW">LW</option>
                <option value="RW">RW</option>
                <option value="ST">ST</option>
            </select>
    
            <label for="newPlayerNationality">Nationalite: </label>
            <input type="text" id="newPlayerNationality" placeholder="Nationality" required>
    
            <label for="newPlayerRating">Rating: </label>
            <input type="number" id="newPlayerRating" placeholder="Rating" min="40" max="99" required>
    
            <label for="newPlayerPhoto">Photo: </label>
            <input type="file" id="newPlayerPhoto" accept="image/*" required>
    
            <label for="newPlayerFlag">Flag: </label>
            <input type="file" id="newPlayerFlag" accept="image/*" required>
    
            <label for="newPlayerLogo">Logo: </label>
            <input type="file" id="newPlayerLogo" accept="image/*" required>
    
            <div id="GKFields" class="position-specific">
                <label for="newPlayerDiving">Diving: </label>
                <input type="number" id="newPlayerDiving" min="1" max="99">
                <label for="newPlayerHandling">Handling: </label>
                <input type="number" id="newPlayerHandling" min="1" max="99">
                <label for="newPlayerKicking">Kicking: </label>
                <input type="number" id="newPlayerKicking" min="1" max="99">
                <label for="newPlayerReflexes">Reflexes: </label>
                <input type="number" id="newPlayerReflexes" min="1" max="99">
                <label for="newPlayerSpeed">Speed: </label>
                <input type="number" id="newPlayerSpeed" min="1" max="99">
                <label for="newPlayerPositioning">Positioning: </label>
                <input type="number" id="newPlayerPositioning" min="1" max="99">
            </div>
    
            <div id="OtherFields" class="position-specific">
                <label for="newPlayerPace">Pace: </label>
                <input type="number" id="newPlayerPace" min="1" max="99">
                <label for="newPlayerShooting">Shooting: </label>
                <input type="number" id="newPlayerShooting" min="1" max="99">
                <label for="newPlayerPassing">Passing: </label>
                <input type="number" id="newPlayerPassing" min="1" max="99">
                <label for="newPlayerDribbling">Dribbling: </label>
                <input type="number" id="newPlayerDribbling" min="1" max="99">
                <label for="newPlayerDefending">Defending: </label>
                <input type="number" id="newPlayerDefending" min="1" max="99">
                <label for="newPlayerPhysical">Physical: </label>
                <input type="number" id="newPlayerPhysical" min="1" max="99">
            </div>
    
            <button type="submit">Create Player</button>
        </form>
    </div>
    
    <div id="playerCards"></div>

    
    
    <div id="successMessage" style="display: none; position: fixed; top: 20px; left: 50%; transform: translateX(-50%); background-color: #4CAF50; color: white; padding: 15px; border-radius: 5px; z-index: 1000;">
        Player created successfully!
    </div>

    <div id="fol"></div>
<script>
    
async function uploadImage(file) {
    return new Promise((resolve, reject) => {
        cloudinary.uploader.upload(file, {
            folder: 'player_images',  // Optional: specify a folder for your images
            resource_type: 'auto'     // Automatically handle different formats
        }, (error, result) => {
            if (error) {
                reject(error);
            } else {
                resolve(result.secure_url);  // Return the URL of the uploaded image
            }
        });
    });
}



        const formations = {
            '4-4-2': [
                [{name: 'ST', index: 0}, {name: 'ST', index: 1}],
                [{name: 'LM', index: 2}, {name: 'CM', index: 3}, {name: 'CM', index: 4}, {name: 'RM', index: 5}],
                [{name: 'LB', index: 6}, {name: 'CB', index: 7}, {name: 'CB', index: 8}, {name: 'RB', index: 9}],
                [{name: 'GK', index: 10}]
            ],
            '4-3-3': [
                [{name: 'LW', index: 0}, {name: 'ST', index: 1}, {name: 'RW', index: 2}],
                [{name: 'CM', index: 3}, {name: 'CM', index: 4}, {name: 'CM', index: 5}],
                [{name: 'LB', index: 6}, {name: 'CB', index: 7}, {name: 'CB', index: 8}, {name: 'RB', index: 9}],
                [{name: 'GK', index: 10}]
            ],
            '3-5-2': [
                [{name: 'CF', index: 0}, {name: 'CF', index: 1}],
                [{name: 'LMF', index: 2}, {name: 'CMF', index: 3}, {name: 'DMF', index: 4}, {name: 'CMF', index: 5}, {name: 'RMF', index: 6}],
                [{name: 'CB', index: 7}, {name: 'CB', index: 8}, {name: 'CB', index: 9}],
                [{name: 'GK', index: 10}]
            ]
        };

        let selectedFormation = '4-4-2';
        let selectedPlayers = Array(11).fill(null);
        let currentPosition = null;
        let players = [];

        const formationElement = document.getElementById('formation');
        const lineupSelect = document.getElementById('lineup');
        const modal = document.getElementById('playerModal');
        const closeBtn = document.getElementsByClassName('close')[0];
        const playersGrid = document.getElementById('playersGrid');
        const nameFilter = document.getElementById('nameFilter');
        const positionFilter = document.getElementById('positionFilter');
        const nationalityFilter = document.getElementById('nationalityFilter');
        const ratingFilter = document.getElementById('ratingFilter');
        const ratingValue = document.getElementById('ratingValue');
        const createdPlayersContainer = document.getElementById('createdPlayers');

        fetch('../data/data.json')
            .then(response => {
                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }
                return response.json();  
            })
            .then(data => {
                players = data.players;
                initializeApp();
            })
            .catch(error => {
                console.error('There was a problem with the fetch operation:', error);
            });

        function initializeApp() {
            renderFormation();
            setupEventListeners();
            populateNationalityFilter();
            renderCreatedPlayers();
        }

        function renderFormation() {
            formationElement.innerHTML = '';
            formations[selectedFormation].forEach(row => {
                const rowElement = document.createElement('div');
                rowElement.className = 'row';
                row.forEach(position => {
                    const card = document.createElement('div');
                    card.className = 'card';
                    card.onclick = () => openModal(position.index, position.name);
                    if (selectedPlayers[position.index]) {
                        const player = selectedPlayers[position.index];
                        card.innerHTML = createPlayerCardHTML(player);
                    } else {
                        card.innerHTML = createEmptyCardHTML(position);
                    }
                    rowElement.appendChild(card);
                });
                formationElement.appendChild(rowElement);
            });
        }

        function createPlayerCardHTML(player) {
            if (player.position === 'GK') {
                return `
                    <div class="card-inner">
                        <div class="header" style="position: relative; top:-11px;">
                            <div class="rating">${player.rating}</div>
                            <div class="position">${player.position}</div>
                        </div>
                        <div class="player-image" style="position: relative; bottom:-18px;">
                            <img src="${player.photo}" alt="${player.name}" />
                        </div>
                        <div class="player-name">${player.name}</div>
                        <div class="stats">
                            <div class="stat"><span>DIV</span><span>${player.diving}</span></div>
                            <div class="stat"><span>HAN</span><span>${player.handling}</span></div>
                            <div class="stat"><span>KIC</span><span>${player.kicking}</span></div>
                            <div class="stat"><span>REF</span><span>${player.reflexes}</span></div>
                            <div class="stat"><span>SPE</span><span>${player.speed}</span></div>
                            <div class="stat"><span>POS</span><span>${player.positioning}</span></div>
                        </div>
                        <div class="shine"></div>
                        <div class="flags">
                            <img src="${player.flag}" class="flag" style="position:relative; bottom:-15px; width:40px;" />
                            <img src="${player.logo}" alt="Logo player" class="flag" style="position:relative; width:40px;" />
                        </div>
                    </div>
                `;
                
            } else {
                return `
                    <div class="card-inner">
                        <div class="header" style="position: relative; top:-11px;">
                            <div class="rating">${player.rating}</div>
                            <div class="position">${player.position}</div>
                        </div>
                        <div class="player-image" style="position: relative; bottom:-18px;">
                            <img src="${player.photo}" alt="${player.name}" />
                        </div>
                        <div class="player-name">${player.name}</div>
                        <div class="stats">
                            <div class="stat"><span>PAC</span><span>${player.pace}</span></div>
                            <div class="stat"><span>SHO</span><span>${player.shooting}</span></div>
                            <div class="stat"><span>PAS</span><span>${player.passing}</span></div>
                            <div class="stat"><span>DRI</span><span>${player.dribbling}</span></div>
                            <div class="stat"><span>DEF</span><span>${player.defending}</span></div>
                            <div class="stat"><span>PHY</span><span>${player.physical}</span></div>
                        </div>
                        <div class="shine"></div>
                        <div class="flags">
                            <img src="${player.flag}" class="flag" style="position:relative; bottom:-15px; width:40px;" />
                            <img src="${player.logo}" alt="Logo player" class="flag" style="position:relative; width:40px;" />
                        </div>
                    </div>
                `;
            }
        }

        function createEmptyCardHTML(position) {
            return `
                <div>${position.name}</div>
                
                <div class="card-inner" style="width:120px; height:120px;">
                    <div class="header" style="position: relative; top:-11px;">
                        <div><img id="add-icon" src="https://cdn-icons-png.flaticon.com/512/166/166344.png" alt="Add Icon" />
                            <div class="add-icon-container">
                                <span class="add-icon">+</span>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function openModal(position, positionName) {
            currentPosition = position;
            modal.style.display = 'block';
            positionFilter.value = positionName;
            renderPlayers();
        }

        function renderPlayers() {
            const filteredPlayers = players.filter(player => 
                player.name.toLowerCase().includes(nameFilter.value.toLowerCase()) &&
                (positionFilter.value === '' || player.position === positionFilter.value) &&
                (nationalityFilter.value === '' || player.nationality === nationalityFilter.value) &&
                player.rating >= parseInt(ratingFilter.value)
            );

            playersGrid.innerHTML = '';
            filteredPlayers.forEach(player => {
                const playerCard = document.createElement('div');
                playerCard.className = 'card-inner';
                playerCard.innerHTML = createPlayerCardHTML(player);
                playerCard.onclick = () => selectPlayer(player);
                playersGrid.appendChild(playerCard);
            });
        }

        function selectPlayer(player) {
            selectedPlayers[currentPosition] = player;
            modal.style.display = 'none';
            renderFormation();
        }

        function setupEventListeners() {
            lineupSelect.onchange = (e) => {
                selectedFormation = e.target.value;
                selectedPlayers = Array(11).fill(null);
                renderFormation();
            };

            closeBtn.onclick = () => {
                modal.style.display = 'none';
            };

            window.onclick = (e) => {
                if (e.target === modal) {
                    modal.style.display = 'none';
                }
            };

            nameFilter.oninput = renderPlayers;
            positionFilter.onchange = renderPlayers;
            nationalityFilter.onchange = renderPlayers;
            ratingFilter.oninput = () => {
                ratingValue.textContent = ratingFilter.value;
                renderPlayers();
            };

            document.getElementById('btn-primary').addEventListener('click', function() {
                document.getElementById('Formulaire_remplir').style.display = 'block';
            });



            async function uploadImage(file) {
    return new Promise((resolve, reject) => {
        cloudinary.uploader.upload(file, {
            folder: 'player_images',  // Optionnel: spécifiez un dossier pour vos images
            resource_type: 'auto'     // Gestion automatique des formats d'image
        }, (error, result) => {
            if (error) {
                reject(error);  // Rejeter la promesse en cas d'erreur
            } else {
                resolve(result.secure_url);  // Retourner l'URL de l'image téléchargée
            }
        });
    });
}

        // Logique de gestion du formulaire
document.getElementById('newPlayerForm').addEventListener('submit', async function(e) {
    e.preventDefault();

    const formData = new FormData(this);
    const newPlayer = {
        id: players.length + 1,
        name: formData.get('newPlayerName'),
        position: formData.get('newPlayerPosition'),
        nationality: formData.get('newPlayerNationality'),
        rating: parseInt(formData.get('newPlayerRating')),
        pace: 70,
        shooting: 70,
        passing: 70,
        dribbling: 70,
        defending: 70,
        physical: 70,
        diving: 70,
        handling: 70,
        kicking: 70,
        reflexes: 70,
        speed: 70,
        positioning: 70
    };

    try {
        // Récupérer les fichiers image
        const playerPhoto = formData.get('newPlayerPhoto');
        const playerFlag = formData.get('newPlayerFlag');
        const playerLogo = formData.get('newPlayerLogo');

        // Télécharger les images sur Cloudinary
        const photoUrl = await uploadImage(playerPhoto);
        const flagUrl = await uploadImage(playerFlag);
        const logoUrl = await uploadImage(playerLogo);

        // Ajouter les URLs des images au joueur
        newPlayer.photo = photoUrl;
        newPlayer.flag = flagUrl;
        newPlayer.logo = logoUrl;

        // Vérifiez si le joueur est un gardien et ajoutez les stats
        if (newPlayer.position === 'GK') {
            newPlayer.diving = parseInt(formData.get('newPlayerDiving'));
            newPlayer.handling = parseInt(formData.get('newPlayerHandling'));
            newPlayer.kicking = parseInt(formData.get('newPlayerKicking'));
            newPlayer.reflexes = parseInt(formData.get('newPlayerReflexes'));
            newPlayer.speed = parseInt(formData.get('newPlayerSpeed'));
            newPlayer.positioning = parseInt(formData.get('newPlayerPositioning'));
        } else {
            newPlayer.pace = parseInt(formData.get('newPlayerPace'));
            newPlayer.shooting = parseInt(formData.get('newPlayerShooting'));
            newPlayer.passing = parseInt(formData.get('newPlayerPassing'));
            newPlayer.dribbling = parseInt(formData.get('newPlayerDribbling'));
            newPlayer.defending = parseInt(formData.get('newPlayerDefending'));
            newPlayer.physical = parseInt(formData.get('newPlayerPhysical'));
        }

        // Ajouter le joueur à la liste des joueurs
        players.push(newPlayer);

        // Réinitialiser le formulaire et masquer le formulaire
        document.getElementById('Formulaire_remplir').style.display = 'none';
        this.reset();

        // Rafraîchir l'affichage
        populateNationalityFilter();
        renderPlayers();
        renderCreatedPlayers();

        // Afficher un message de succès
        showSuccessMessage();
    } catch (error) {
        console.error('Erreur lors du téléchargement des images: ', error);
        alert('Une erreur est survenue lors du téléchargement des images.');
    }
    // 
});

            document.getElementById('newPlayerPosition').addEventListener('change', function() {
                var selectedPosition = this.value;
                
                // Hide all position-specific fields
                var positionFields = document.querySelectorAll('.position-specific');
                positionFields.forEach(function(field) {
                    field.style.display = 'none';
                });

                // Show the corresponding position-specific fields
                if (selectedPosition === 'GK') {
                    document.getElementById('GKFields').style.display = 'block';
                } else {
                    document.getElementById('OtherFields').style.display = 'block';
                }
            });
        }

        function populateNationalityFilter() {
            const nationalities = [...new Set(players.map(p => p.nationality))];
            nationalityFilter.innerHTML = '<option value="">Nationality</option>';
            nationalities.forEach(nationality => {
                const option = document.createElement('option');
                option.value = nationality;
                option.textContent = nationality;
                nationalityFilter.appendChild(option);
            });
        }

        function isPositionCompatible(playerPosition, formationPosition) {
            const compatibilityMap = {
                'CF': ['CF', 'ST'],
                'LWF': ['LWF', 'LW', 'LM'],
                'RWF': ['RWF', 'RW', 'RM'],
                'LMF': ['LMF', 'LM', 'LW'],
                'RMF': ['RMF', 'RM', 'RW'],
                'CMF': ['CMF', 'CM'],
                'DMF': ['DMF', 'CDM'],
                'LB': ['LB', 'LWB'],
                'RB': ['RB', 'RWB'],
                'CB': ['CB'],
                'GK': ['GK']
            };

            return compatibilityMap[formationPosition].includes(playerPosition);
        }

        function renderCreatedPlayers() {
            createdPlayersContainer.innerHTML = '';
            players.forEach(player => {
                const playerCard = document.createElement('div');
                playerCard.className = 'card';
                playerCard.innerHTML = createPlayerCardHTML(player);
                createdPlayersContainer.appendChild(playerCard);
            });
        }

        function showSuccessMessage() {
            const successMessage = document.getElementById('successMessage');
            successMessage.style.display = 'block';
            setTimeout(() => {
                successMessage.style.display = 'none';
            }, 3000);
        }

        // Initialize the app
        initializeApp();

        // 


function displayPlayerCard(player) {
    const playersGrid = document.getElementById('playersGrid'); // The container where cards are shown

    const card = document.createElement('div');
    card.classList.add('card');

    let cardContent = `
        <div class="card-inner">
            <div class="header" style="position: relative; top:-11px;">
                <div class="rating">${player.rating}</div>
                <div class="position">${player.position}</div>
            </div>
            <div class="player-image" style="position: relative; bottom:-18px;">
                <img src="${player.photo}" alt="${player.name}" />
            </div>
            <div class="player-name">${player.name}</div>
            <div class="stats">
    `;

    if (player.position === 'GK') {
        cardContent += `
            <div class="stat"><span>DIV</span><span>${player.diving}</span></div>
            <div class="stat"><span>HAN</span><span>${player.handling}</span></div>
            <div class="stat"><span>KIC</span><span>${player.kicking}</span></div>
            <div class="stat"><span>REF</span><span>${player.reflexes}</span></div>
            <div class="stat"><span>SPE</span><span>${player.speed}</span></div>
            <div class="stat"><span>POS</span><span>${player.positioning}</span></div>
        `;
    } else {
        cardContent += `
            <div class="stat"><span>PAC</span><span>${player.pace}</span></div>
            <div class="stat"><span>SHO</span><span>${player.shooting}</span></div>
            <div class="stat"><span>PAS</span><span>${player.passing}</span></div>
            <div class="stat"><span>DRI</span><span>${player.dribbling}</span></div>
            <div class="stat"><span>DEF</span><span>${player.defending}</span></div>
            <div class="stat"><span>PHY</span><span>${player.physical}</span></div>
        `;
    }

    cardContent += `
            </div>
            <div class="shine"></div>
            <div class="flags">
                <img src="${player.flag}" class="flag" style="position:relative; bottom:-15px; width:40px;" />
                <img src="${player.logo}" alt="Logo player" class="flag" style="position:relative; width:40px;" />
            </div>
        </div>
    `;

    card.innerHTML = cardContent;
    playersGrid.appendChild(card);
}

// partei 2 

document.addEventListener('DOMContentLoaded', function() {
    displayPlayerCards(); // Load players from localStorage on page load

    // Add event listener to form submission
    document.getElementById('newPlayerForm').addEventListener('submit', function(event) {
        event.preventDefault();

        const playerName = document.getElementById('newPlayerName').value;
        const playerPosition = document.getElementById('newPlayerPosition').value;
        const playerNationality = document.getElementById('newPlayerNationality').value;
        const playerRating = document.getElementById('newPlayerRating').value;

        const playerPhoto = document.getElementById('newPlayerPhoto').files[0];
        const playerFlag = document.getElementById('newPlayerFlag').files[0];
        const playerLogo = document.getElementById('newPlayerLogo').files[0];

        const player = {
            name: playerName,
            position: playerPosition,
            nationality: playerNationality,
            rating: playerRating,
            photo: URL.createObjectURL(playerPhoto),
            flag: URL.createObjectURL(playerFlag),
            logo: URL.createObjectURL(playerLogo),
        };

        if (playerPosition === 'GK') {
            player.diving = document.getElementById('newPlayerDiving').value;
            player.handling = document.getElementById('newPlayerHandling').value;
            player.kicking = document.getElementById('newPlayerKicking').value;
            player.reflexes = document.getElementById('newPlayerReflexes').value;
            player.speed = document.getElementById('newPlayerSpeed').value;
            player.positioning = document.getElementById('newPlayerPositioning').value;
        } else {
            player.pace = document.getElementById('newPlayerPace').value;
            player.shooting = document.getElementById('newPlayerShooting').value;
            player.passing = document.getElementById('newPlayerPassing').value;
            player.dribbling = document.getElementById('newPlayerDribbling').value;
            player.defending = document.getElementById('newPlayerDefending').value;
            player.physical = document.getElementById('newPlayerPhysical').value;
        }

        let players = JSON.parse(localStorage.getItem('players')) || [];
        players.push(player);
        // localStorage.setItem('players', JSON.stringify(players));
        localStorage.setItem('players', JSON.stringify(players));

        alert('Player created successfully!');
        displayPlayerCards(); // Refresh the cards after adding a new player
    });
});

// Function to display the cards from localStorage

// ttt
function displayPlayerCards() {
    const playersGrid = document.getElementById('playerCardsContainer');
    playersGrid.innerHTML = ''; // Clear any existing cards

    const players = JSON.parse(localStorage.getItem('players')) || [];

    players.forEach((player, index) => {
        const card = document.createElement('div');
        card.classList.add('card');
        card.dataset.index = index; // Store the player index in the card for future reference

        // Utiliser la fonction createPlayerCardHTML pour générer le contenu HTML de la carte
        const cardContent = createPlayerCardHTML(player);
        card.innerHTML = cardContent;

        // Ajouter la carte au conteneur
        playersGrid.appendChild(card);

        function selectPlayer(player) {
            selectedPlayers[currentPosition] = player;
            modal.style.display = 'none';
            renderFormation();
        }

        function renderFormation() {
            formationElement.innerHTML = '';
            formations[selectedFormation].forEach(row => {
                const rowElement = document.createElement('div');
                rowElement.className = 'row';
                row.forEach(position => {
                    const card = document.createElement('div');
                    card.className = 'card';
                    card.onclick = () => openModal(position.index, position.name);
                    if (selectedPlayers[position.index]) {
                        const player = selectedPlayers[position.index];
                        card.innerHTML = createPlayerCardHTML(player);
                    } else {
                        card.innerHTML = createEmptyCardHTML(position);
                    }
                    rowElement.appendChild(card);
                });
                formationElement.appendChild(rowElement);
            });
        }
        // Ajouter un écouteur d'événement sur la carte pour afficher les détails du joueur
        card.addEventListener('click', function() {
            // Récupérer l'index du joueur à partir du dataset
            const index = card.dataset.index;
            const players = JSON.parse(localStorage.getItem('players')) || [];

            // Vérifier que l'index est valide
            if (index >= 0 && index < players.length) {
                const player = players[index];

                // Trouver l'élément où afficher les informations du joueur
                const playerDetails = document.getElementById('player-details');
                
                playerDetails.innerHTML = `
                    <h3>Modifier les Informations du Joueur</h3>
                    <label>Name: </label> <input type="text" id="player-name" value="${player.name}"> </br>
                    <label>Diving: </label> <input type="text" id="player-diving" value="${player.diving}"> </br>
                    <label>Position: </label> <input type="text" id="player-position" value="${player.position}"> </br>
                    <label>Handling: </label> <input type="text" id="player-handling" value="${player.handling}"> </br>
                    <label>Kicking: </label> <input type="text" id="player-kicking" value="${player.kicking}"> </br>
                    <label>Nationality: </label> <input type="text" id="player-nationality" value="${player.nationality}"> </br>

                    <label>Logo: </label> <img src="${player.logo}" class="flag" id="logo-preview"> </br>
                    <label>Logo (Upload): </label> <input type="file" id="player-logo-file"> </br>

                    <label>Photo: </label> <img src="${player.photo}" class="flag" id="photo-preview"> </br>
                    <label>Photo (Upload): </label> <input type="file" id="player-photo-file"> </br>

                    <label>Positioning: </label> <input type="text" id="player-positioning" value="${player.positioning}"> </br>
                    <label>Rating: </label> <input type="text" id="player-rating" value="${player.rating}"> </br>
                    <label>Reflexes: </label> <input type="text" id="player-reflexes" value="${player.reflexes}"> </br>
                    <label>Speed: </label> <input type="text" id="player-speed" value="${player.speed}"> </br>

                    <input type="submit" id="save-btn" value="Enregistrer">
                `;

                // Ajouter un événement pour sauvegarder les modifications
                const saveBtn = document.getElementById('save-btn');
                saveBtn.addEventListener('click', function() {
                    // Mettre à jour les informations du joueur
                    player.name = document.getElementById('player-name').value;
                    player.diving = document.getElementById('player-diving').value;
                    player.position = document.getElementById('player-position').value;
                    player.handling = document.getElementById('player-handling').value;
                    player.kicking = document.getElementById('player-kicking').value;
                    player.nationality = document.getElementById('player-nationality').value;
                    player.logo = document.getElementById('player-logo-file').files[0] ? URL.createObjectURL(document.getElementById('player-logo-file').files[0]) : player.logo;
                    player.photo = document.getElementById('player-photo-file').files[0] ? URL.createObjectURL(document.getElementById('player-photo-file').files[0]) : player.photo;
                    player.positioning = document.getElementById('player-positioning').value;
                    player.rating = document.getElementById('player-rating').value;
                    player.reflexes = document.getElementById('player-reflexes').value;
                    player.speed = document.getElementById('player-speed').value;

                    // Sauvegarder les modifications dans le localStorage
                    players[index] = player;
                    localStorage.setItem('players', JSON.stringify(players));

                    // Actualiser la page avec les nouvelles informations
                    displayPlayerCards();
                });
            } else {
                alert('Index invalide');
            }
        });

        // Ajouter les boutons "Modify" et "Delete" à chaque carte
        card.querySelector('.modify-btn').addEventListener('click', function() {
            const fol = document.getElementById('fol');
            const players = JSON.parse(localStorage.getItem('players')) || [];

            if (index >= 0 && index < players.length) {
                const player = players[index];

                fol.innerHTML = `
                    <label>Name: </label> <input type="text" id="player-name" value="${player.name}"> </br>
                    <label>Diving: </label> <input type="text" id="player-diving" value="${player.diving}"> </br>
                    <label>Position: </label> <input type="text" id="player-position" value="${player.position}"> </br>
                    <label>Handling: </label> <input type="text" id="player-handling" value="${player.handling}"> </br>
                    <label>Kicking: </label> <input type="text" id="player-kicking" value="${player.kicking}"> </br>
                    <label>Nationality: </label> <input type="text" id="player-nationality" value="${player.nationality}"> </br>

                    <label>Logo: </label> <img src="${player.logo}" class="flag" id="logo-preview"> </br>
                    <label>Logo (Upload): </label> <input type="file" id="player-logo-file"> </br>

                    <label>Photo: </label> <img src="${player.photo}" class="flag" id="photo-preview"> </br>
                    <label>Photo (Upload): </label> <input type="file" id="player-photo-file"> </br>

                    <label>Positioning: </label> <input type="text" id="player-positioning" value="${player.positioning}"> </br>
                    <label>Rating: </label> <input type="text" id="player-rating" value="${player.rating}"> </br>
                    <label>Reflexes: </label> <input type="text" id="player-reflexes" value="${player.reflexes}"> </br>
                    <label>Speed: </label> <input type="text" id="player-speed" value="${player.speed}"> </br>

                    <input type="submit" id="save-btn" value="Enregistrer">
                `;
            } else {
                alert('Index invalide');
            }
        });

        // Ajouter un événement pour supprimer le joueur
        card.querySelector('.delete-btn').addEventListener('click', function() {
            deletePlayer(index);
        });
    });
}


function displayPlayerDetails(index) {
    const players = JSON.parse(localStorage.getItem('players')) || [];
    const player = players[index];

    const detailContainer = document.getElementById('player-details'); // Assuming you have a div for details

    let playerDetails = `
        <h2>Player Details</h2>
        <p><strong>Name: </strong>${player.name}</p>
        <p><strong>Position: </strong>${player.position}</p>
        <p><strong>Rating: </strong>${player.rating}</p>
    `;

    if (player.position === 'GK') {
        playerDetails += `
            <p><strong>DIV: </strong>${player.diving}</p>
            <p><strong>HAN: </strong>${player.handling}</p>
            <p><strong>KIC: </strong>${player.kicking}</p>
            <p><strong>REF: </strong>${player.reflexes}</p>
            <p><strong>SPE: </strong>${player.speed}</p>
            <p><strong>POS: </strong>${player.positioning}</p>
        `;
    } else {
        playerDetails += `
            <p><strong>PAC: </strong>${player.pace}</p>
            <p><strong>SHO: </strong>${player.shooting}</p>
            <p><strong>PAS: </strong>${player.passing}</p>
            <p><strong>DRI: </strong>${player.dribbling}</p>
            <p><strong>DEF: </strong>${player.defending}</p>
            <p><strong>PHY: </strong>${player.physical}</p>
        `;
    }

    playerDetails += `
        <img src="${player.photo}" alt="Player Photo" />
        <img src="${player.logo}" alt="Player Logo" />
    `;

    detailContainer.innerHTML = playerDetails; // Insert the details into the container
}


// Function to modify a player
function modifyPlayer(player, index) {
    // Prefill the form with the current player's data for modification
    document.getElementById('newPlayerName').value = player.name;
    document.getElementById('newPlayerPosition').value = player.position;
    document.getElementById('newPlayerNationality').value = player.nationality;
    document.getElementById('newPlayerRating').value = player.rating;

    if (player.position === 'GK') {
        document.getElementById('newPlayerDiving').value = player.diving;
        document.getElementById('newPlayerHandling').value = player.handling;
        document.getElementById('newPlayerKicking').value = player.kicking;
        document.getElementById('newPlayerReflexes').value = player.reflexes;
        document.getElementById('newPlayerSpeed').value = player.speed;
        document.getElementById('newPlayerPositioning').value = player.positioning;
    } else {
        document.getElementById('newPlayerPace').value = player.pace;
        document.getElementById('newPlayerShooting').value = player.shooting;
        document.getElementById('newPlayerPassing').value = player.passing;
        document.getElementById('newPlayerDribbling').value = player.dribbling;
        document.getElementById('newPlayerDefending').value = player.defending;
        document.getElementById('newPlayerPhysical').value = player.physical;
    }
}

// Function to delete a player
function deletePlayer(index) {
    let players = JSON.parse(localStorage.getItem('players')) || [];
    players.splice(index, 1); // Remove player from array
    localStorage.setItem('players', JSON.stringify(players));
    
    displayPlayerCards(); // Refresh the display
}

document.getElementById('newPlayerForm').addEventListener('submit', function(e) {
    e.preventDefault();

    const formData = new FormData(this);

    // Création de l'objet player
    const newPlayer = {
        id: players.length + 1,
        name: formData.get('newPlayerName'),
        position: formData.get('newPlayerPosition'),
        nationality: formData.get('newPlayerNationality'),
        rating: parseInt(formData.get('newPlayerRating')),
        pace: 70,
        shooting: 70,
        passing: 70,
        dribbling: 70,
        defending: 70,
        physical: 70,
        diving: 70,
        handling: 70,
        kicking: 70,
        reflexes: 70,
        speed: 70,
        positioning: 70
    };

    // Récupérer les images téléchargée
    const playerPhoto = formData.get('newPlayerPhoto');
    const playerFlag = formData.get('newPlayerFlag');
    const playerLogo = formData.get('newPlayerLogo');

    // Créer une URL pour chaque image téléchargée
    const photoUrl = URL.createObjectURL(playerPhoto);
    const flagUrl = URL.createObjectURL(playerFlag);
    const logoUrl = URL.createObjectURL(playerLogo);

    // Ajouter les URLs des images à l'objet du joueur
    newPlayer.photo = photoUrl;
    newPlayer.flag = flagUrl;
    newPlayer.logo = logoUrl;

    // Vérifie si le joueur est un gardien
    if (newPlayer.position === 'GK') {
        newPlayer.diving = parseInt(formData.get('newPlayerDiving'));
        newPlayer.handling = parseInt(formData.get('newPlayerHandling'));
        newPlayer.kicking = parseInt(formData.get('newPlayerKicking'));
        newPlayer.reflexes = parseInt(formData.get('newPlayerReflexes'));
        newPlayer.speed = parseInt(formData.get('newPlayerSpeed'));
        newPlayer.positioning = parseInt(formData.get('newPlayerPositioning'));
    } else {
        newPlayer.pace = parseInt(formData.get('newPlayerPace'));
        newPlayer.shooting = parseInt(formData.get('newPlayerShooting'));
        newPlayer.passing = parseInt(formData.get('newPlayerPassing'));
        newPlayer.dribbling = parseInt(formData.get('newPlayerDribbling'));
        newPlayer.defending = parseInt(formData.get('newPlayerDefending'));
        newPlayer.physical = parseInt(formData.get('newPlayerPhysical'));
    }

    // Ajoute le joueur à la liste des joueurs
    players.push(newPlayer);

    // Masquer le formulaire et réinitialiser
    document.getElementById('Formulaire_remplir').style.display = 'none';
    this.reset();

    populateNationalityFilter();
    renderPlayers();
    renderCreatedPlayers();

    showSuccessMessage();
});
// 


  
</script>
</body>
</html>
